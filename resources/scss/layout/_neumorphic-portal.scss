// ================================
// Neumorphic Portal Base Layout
// Shared styles for all portals
// ================================

// Main portal wrapper
.neu-portal {
  min-height: 100vh;
  background: var(--bg-primary);
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
  display: flex;
}

// Sidebar navigation
.neu-portal-sidebar {
  @include neu-sidebar($neu-light-bg);
  width: 260px;
  flex-shrink: 0;
  position: fixed;
  left: 0;
  top: 0;
  bottom: 0;
  z-index: 100;

  .sidebar-header {
    padding: 0 1.5rem 2rem;
    border-bottom: 1px solid var(--border-color);
    margin-bottom: 1rem;

    .logo {
      font-size: 1.5rem;
      font-weight: 700;
      color: var(--accent-primary);
      text-decoration: none;
      display: block;
      text-align: center;
    }
  }

  .sidebar-nav {
    a {
      @include neu-nav-link($neu-light-bg, $neu-light-primary);

      @media (prefers-color-scheme: dark) {
        @include neu-nav-link($neu-dark-bg, $neu-dark-primary);
      }
    }
  }

  .sidebar-footer {
    position: absolute;
    bottom: 2rem;
    left: 1rem;
    right: 1rem;

    .user-profile {
      @include neu-raised($neu-distance-sm * 0.5, $neu-blur-sm * 0.6, $neu-light-bg);
      padding: 0.875rem;
      border-radius: 12px;
      display: flex;
      align-items: center;
      gap: 0.75rem;
      width: 100%;
      border: none;
      background: $neu-light-bg;
      cursor: pointer;
      transition: all 0.3s ease;
      text-align: left;

      &:hover {
        @include neu-convex($neu-distance-sm * 0.5, $neu-blur-sm * 0.6, $neu-light-bg);
        transform: translateY(-1px);
      }

      &:active {
        @include neu-sunken($neu-distance-sm * 0.3, $neu-blur-sm * 0.5, $neu-light-bg);
        transform: translateY(0);
      }

      .avatar {
        @include neu-raised($neu-distance-sm * 0.3, $neu-blur-sm * 0.4, $neu-light-bg);
        width: 40px;
        height: 40px;
        border-radius: 10px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-weight: 600;
        color: $neu-light-primary;
        flex-shrink: 0;
      }

      .user-info {
        flex: 1;
        min-width: 0;

        .name {
          font-weight: 600;
          color: $neu-light-text;
          font-size: 0.875rem;
          margin-bottom: 0.125rem;
          overflow: hidden;
          text-overflow: ellipsis;
          white-space: nowrap;
        }

        .role {
          font-size: 0.75rem;
          color: $neu-light-text-muted;
        }
      }

      .profile-chevron {
        flex-shrink: 0;
        color: $neu-light-text-muted;
        transition: transform 0.3s ease;
      }

      &:hover .profile-chevron {
        transform: translateX(2px);
        color: $neu-light-primary;
      }

      @media (prefers-color-scheme: dark) {
        @include neu-raised($neu-distance-sm * 0.5, $neu-blur-sm * 0.6, $neu-dark-bg);
        background: $neu-dark-bg;

        &:hover {
          @include neu-convex($neu-distance-sm * 0.5, $neu-blur-sm * 0.6, $neu-dark-bg);
        }

        &:active {
          @include neu-sunken($neu-distance-sm * 0.3, $neu-blur-sm * 0.5, $neu-dark-bg);
        }

        .avatar {
          @include neu-raised($neu-distance-sm * 0.3, $neu-blur-sm * 0.4, $neu-dark-bg);
          color: $neu-dark-primary;
        }

        .user-info {
          .name {
            color: $neu-dark-text;
          }

          .role {
            color: $neu-dark-text-muted;
          }
        }

        .profile-chevron {
          color: $neu-dark-text-muted;
        }

        &:hover .profile-chevron {
          color: $neu-dark-primary;
        }
      }
    }
  }

  @media (max-width: 768px) {
    transform: translateX(-100%);
    transition: transform 0.3s ease;

    &.open {
      transform: translateX(0);
    }
  }
}

// Main content area
.neu-portal-main {
  flex: 1;
  margin-left: 260px;
  min-height: 100vh;

  @media (max-width: 768px) {
    margin-left: 0;
  }
}

// Top navbar
.neu-portal-navbar {
  @include neu-navbar($neu-light-bg);
  margin: 1.5rem;
  margin-bottom: 0;

  .navbar-left {
    display: flex;
    align-items: center;
    gap: 1rem;

    .menu-toggle {
      @include neu-icon-badge($neu-light-bg);
      display: flex;

      @media (prefers-color-scheme: dark) {
        @include neu-icon-badge($neu-dark-bg);
      }

      @media (min-width: 769px) {
        display: none !important;
      }
    }

    .page-title {
      font-size: 1.5rem;
      font-weight: 700;
      color: $neu-light-text;
      margin: 0;

      @media (prefers-color-scheme: dark) {
        color: $neu-dark-text;
      }
    }
  }

  .navbar-right {
    display: flex;
    align-items: center;
    gap: 1rem;

    .search-wrapper {
      @include neu-search($neu-light-bg);

      @media (prefers-color-scheme: dark) {
        @include neu-search($neu-dark-bg);
      }
    }

    .notification-badge {
      @include neu-icon-badge($neu-light-bg);
      position: relative;

      .badge-dot {
        position: absolute;
        top: 6px;
        right: 6px;
        width: 8px;
        height: 8px;
        background: $neu-light-danger;
        border-radius: 50%;
        border: 2px solid $neu-light-bg;

        @media (prefers-color-scheme: dark) {
          background: $neu-dark-danger;
          border-color: $neu-dark-bg;
        }
      }

      @media (prefers-color-scheme: dark) {
        @include neu-icon-badge($neu-dark-bg);
      }
    }
  }

  @media (prefers-color-scheme: dark) {
    @include neu-navbar($neu-dark-bg);
  }
}

// Content area
.neu-portal-content {
  padding: 1.5rem;

  .content-header {
    margin-bottom: 2rem;

    .breadcrumb {
      display: flex;
      gap: 0.5rem;
      align-items: center;
      margin-bottom: 0.75rem;
      font-size: 0.875rem;
      color: $neu-light-text-muted;

      a {
        color: $neu-light-primary;
        text-decoration: none;

        &:hover {
          text-decoration: underline;
        }
      }

      .separator {
        color: $neu-light-text-muted;
      }

      @media (prefers-color-scheme: dark) {
        color: $neu-dark-text-muted;

        a {
          color: $neu-dark-primary;
        }

        .separator {
          color: $neu-dark-text-muted;
        }
      }
    }

    .actions {
      display: flex;
      gap: 0.75rem;
      flex-wrap: wrap;
    }
  }
}

// Dashboard grid
.neu-dashboard-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
  gap: 1.5rem;
  margin-bottom: 2rem;
}

// Generic card
.neu-card {
  @include neu-card($neu-light-bg);

  @media (prefers-color-scheme: dark) {
    @include neu-card($neu-dark-bg);
  }
}

// Stat cards
.neu-stat-card {
  @include neu-stat-card($neu-light-bg);

  @media (prefers-color-scheme: dark) {
    @include neu-stat-card($neu-dark-bg);
  }
}

// Widget
.neu-widget {
  @include neu-widget($neu-light-bg);

  @media (prefers-color-scheme: dark) {
    @include neu-widget($neu-dark-bg);
  }
}

// Table wrapper
.neu-table-wrapper {
  @include neu-table-wrapper($neu-light-bg);

  table {
    @include neu-table($neu-light-bg);

    @media (prefers-color-scheme: dark) {
      @include neu-table($neu-dark-bg);
    }
  }

  .table-actions {
    button, a {
      @include neu-table-action($neu-light-bg);

      @media (prefers-color-scheme: dark) {
        @include neu-table-action($neu-dark-bg);
      }
    }
  }

  @media (prefers-color-scheme: dark) {
    @include neu-table-wrapper($neu-dark-bg);
  }
}

// Form elements
.neu-form {
  @include neu-form-container($neu-light-bg);

  @media (prefers-color-scheme: dark) {
    @include neu-form-container($neu-dark-bg);
  }
}

// Global Button Styles
.neu-button-primary {
  @include neu-button-filled($neu-light-primary);

  @media (prefers-color-scheme: dark) {
    @include neu-button-filled($neu-dark-primary);

    // Override white inset shadows for dark mode
    box-shadow:
      #{$neu-distance-sm} #{$neu-distance-sm} #{$neu-blur-sm} darken($neu-dark-primary, 20%),
      #{-$neu-distance-sm} #{-$neu-distance-sm} #{$neu-blur-sm} lighten($neu-dark-primary, 8%),
      inset 0 1px 0 rgba(255, 255, 255, 0.05),
      0 0 0 1px rgba(0, 0, 0, 0.2);

    &:hover {
      box-shadow:
        #{$neu-distance-sm * 1.2} #{$neu-distance-sm * 1.2} #{$neu-blur-sm * 1.2} darken($neu-dark-primary, 22%),
        #{-$neu-distance-sm * 1.2} #{-$neu-distance-sm * 1.2} #{$neu-blur-sm * 1.2} lighten($neu-dark-primary, 10%),
        inset 0 1px 0 rgba(255, 255, 255, 0.08),
        0 0 0 1px rgba(0, 0, 0, 0.25);
    }

    &:active,
    &:focus {
      box-shadow:
        inset #{$neu-distance-sm * 0.6} #{$neu-distance-sm * 0.6} #{$neu-blur-sm * 0.8} darken($neu-dark-primary, 25%),
        inset #{-$neu-distance-sm * 0.6} #{-$neu-distance-sm * 0.6} #{$neu-blur-sm * 0.8} lighten($neu-dark-primary, 5%),
        0 0 0 1px rgba(0, 0, 0, 0.2);
    }
  }
}

.neu-button-secondary {
  @include neu-button($neu-light-bg, $neu-light-text);

  @media (prefers-color-scheme: dark) {
    @include neu-dark-button($neu-dark-text);
  }
}

.neu-button-success {
  @include neu-button-filled($neu-light-success);

  @media (prefers-color-scheme: dark) {
    @include neu-button-filled($neu-dark-success);

    // Override white inset shadows for dark mode
    box-shadow:
      #{$neu-distance-sm} #{$neu-distance-sm} #{$neu-blur-sm} darken($neu-dark-success, 20%),
      #{-$neu-distance-sm} #{-$neu-distance-sm} #{$neu-blur-sm} lighten($neu-dark-success, 8%),
      inset 0 1px 0 rgba(255, 255, 255, 0.05),
      0 0 0 1px rgba(0, 0, 0, 0.2);

    &:hover {
      box-shadow:
        #{$neu-distance-sm * 1.2} #{$neu-distance-sm * 1.2} #{$neu-blur-sm * 1.2} darken($neu-dark-success, 22%),
        #{-$neu-distance-sm * 1.2} #{-$neu-distance-sm * 1.2} #{$neu-blur-sm * 1.2} lighten($neu-dark-success, 10%),
        inset 0 1px 0 rgba(255, 255, 255, 0.08),
        0 0 0 1px rgba(0, 0, 0, 0.25);
    }

    &:active,
    &:focus {
      box-shadow:
        inset #{$neu-distance-sm * 0.6} #{$neu-distance-sm * 0.6} #{$neu-blur-sm * 0.8} darken($neu-dark-success, 25%),
        inset #{-$neu-distance-sm * 0.6} #{-$neu-distance-sm * 0.6} #{$neu-blur-sm * 0.8} lighten($neu-dark-success, 5%),
        0 0 0 1px rgba(0, 0, 0, 0.2);
    }
  }
}

.neu-button-danger {
  @include neu-button-filled($neu-light-danger);

  @media (prefers-color-scheme: dark) {
    @include neu-button-filled($neu-dark-danger);

    // Override white inset shadows for dark mode
    box-shadow:
      #{$neu-distance-sm} #{$neu-distance-sm} #{$neu-blur-sm} darken($neu-dark-danger, 20%),
      #{-$neu-distance-sm} #{-$neu-distance-sm} #{$neu-blur-sm} lighten($neu-dark-danger, 8%),
      inset 0 1px 0 rgba(255, 255, 255, 0.05),
      0 0 0 1px rgba(0, 0, 0, 0.2);

    &:hover {
      box-shadow:
        #{$neu-distance-sm * 1.2} #{$neu-distance-sm * 1.2} #{$neu-blur-sm * 1.2} darken($neu-dark-danger, 22%),
        #{-$neu-distance-sm * 1.2} #{-$neu-distance-sm * 1.2} #{$neu-blur-sm * 1.2} lighten($neu-dark-danger, 10%),
        inset 0 1px 0 rgba(255, 255, 255, 0.08),
        0 0 0 1px rgba(0, 0, 0, 0.25);
    }

    &:active,
    &:focus {
      box-shadow:
        inset #{$neu-distance-sm * 0.6} #{$neu-distance-sm * 0.6} #{$neu-blur-sm * 0.8} darken($neu-dark-danger, 25%),
        inset #{-$neu-distance-sm * 0.6} #{-$neu-distance-sm * 0.6} #{$neu-blur-sm * 0.8} lighten($neu-dark-danger, 5%),
        0 0 0 1px rgba(0, 0, 0, 0.2);
    }
  }
}

// Button group
.neu-button-group {
  display: flex;
  gap: 0.75rem;
  flex-wrap: wrap;

  .neu-button-primary {
    @include neu-button-filled($neu-light-primary);

    @media (prefers-color-scheme: dark) {
      @include neu-button-filled($neu-dark-primary);
    }
  }

  .neu-button-secondary {
    @include neu-button($neu-light-bg, $neu-light-text);

    @media (prefers-color-scheme: dark) {
      @include neu-dark-button($neu-dark-text);
    }
  }

  .neu-button-success {
    @include neu-button-filled($neu-light-success);

    @media (prefers-color-scheme: dark) {
      @include neu-button-filled($neu-dark-success);
    }
  }

  .neu-button-danger {
    @include neu-button-filled($neu-light-danger);

    @media (prefers-color-scheme: dark) {
      @include neu-button-filled($neu-dark-danger);
    }
  }
}

// Badges
.neu-badge {
  @include neu-badge($neu-light-primary, $neu-light-bg);

  &.success {
    @include neu-badge($neu-light-success, $neu-light-bg);
  }

  &.warning {
    @include neu-badge($neu-light-warning, $neu-light-bg);
  }

  &.danger {
    @include neu-badge($neu-light-danger, $neu-light-bg);
  }
}

// Alerts
.neu-alert {
  @include neu-alert('info', $neu-light-bg);

  &.success {
    @include neu-alert('success', $neu-light-bg);
  }

  &.warning {
    @include neu-alert('warning', $neu-light-bg);
  }

  &.danger {
    @include neu-alert('danger', $neu-light-bg);
  }

  @media (prefers-color-scheme: dark) {
    @include neu-alert('info', $neu-dark-bg);

    &.success {
      @include neu-alert('success', $neu-dark-bg);
    }

    &.warning {
      @include neu-alert('warning', $neu-dark-bg);
    }

    &.danger {
      @include neu-alert('danger', $neu-dark-bg);
    }
  }
}

// Lists
.neu-list {
  .neu-list-item {
    @include neu-list-item($neu-light-bg);

    @media (prefers-color-scheme: dark) {
      @include neu-list-item($neu-dark-bg);
    }
  }
}

// Pagination
.neu-pagination {
  @include neu-pagination($neu-light-bg);

  @media (prefers-color-scheme: dark) {
    @include neu-pagination($neu-dark-bg);
  }
}

// Modal
.neu-modal-overlay {
  @include neu-modal-overlay();

  .neu-modal {
    @include neu-modal($neu-light-bg);

    @media (prefers-color-scheme: dark) {
      @include neu-modal($neu-dark-bg);
    }
  }
}

// Empty state
.neu-empty-state {
  @include neu-card($neu-light-bg);
  padding: 3rem 2rem;
  text-align: center;
  border-radius: 18px;

  .empty-icon {
    @include neu-raised($neu-distance-sm * 0.5, $neu-blur-sm * 0.6, $neu-light-bg);
    width: 80px;
    height: 80px;
    border-radius: 16px;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    font-size: 2.5rem;
    color: $neu-light-text-muted;
    margin-bottom: 1.5rem;

    @media (prefers-color-scheme: dark) {
      @include neu-raised($neu-distance-sm * 0.5, $neu-blur-sm * 0.6, $neu-dark-bg);
      color: $neu-dark-text-muted;
    }
  }

  .empty-title {
    font-size: 1.25rem;
    font-weight: 600;
    color: $neu-light-text;
    margin-bottom: 0.5rem;

    @media (prefers-color-scheme: dark) {
      color: $neu-dark-text;
    }
  }

  .empty-message {
    color: $neu-light-text-muted;
    margin-bottom: 1.5rem;

    @media (prefers-color-scheme: dark) {
      color: $neu-dark-text-muted;
    }
  }

  @media (prefers-color-scheme: dark) {
    @include neu-card($neu-dark-bg);
  }
}

// Responsive - show sidebar on large screens
@media (min-width: 769px) {
  .neu-portal {
    .neu-portal-sidebar {
      transform: translateX(0);
    }
  }
}

// Mobile sidebar backdrop
.sidebar-backdrop {
  display: none;
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(0, 0, 0, 0.5);
  z-index: 99;
  opacity: 0;
  transition: opacity 0.3s ease;

  &.active {
    display: block;
    opacity: 1;
  }

  @media (min-width: 769px) {
    display: none !important;
  }
}

// Mobile: sidebar hidden by default
@media (max-width: 768px) {
  .neu-portal-sidebar {
    transform: translateX(-100%);
    transition: transform 0.3s ease;
    z-index: 100;

    &.open {
      transform: translateX(0);
    }
  }
}
